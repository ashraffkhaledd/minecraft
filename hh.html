<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Gift Loop Demo</title>
    <style>
        body {
            margin: 0;
            background: #111;
            color: white;
        }

        .container {
            position: relative;
            height: 50000px;
        }

        .gift {
            width: 60px;
            height: 60px;
            position: absolute;
            cursor: pointer;
            z-index: 10;
        }

        .popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 999;
            background: white;
            padding: 10px;
        }

        .popup img {
            max-width: 90vw;
            max-height: 90vh;
        }
    </style>
</head>

<body>

    <div class="container" id="giftContainer">
        <img src="https://i.imgur.com/1XjK6uK.png" class="gift" style="top: 800px; left: 50px;">
        <img src="https://i.imgur.com/1XjK6uK.png" class="gift" style="top: 1600px; left: 150px;">
        <img src="https://i.imgur.com/1XjK6uK.png" class="gift" style="top: 2400px; left: 250px;">
    </div>

    <div class="popup" id="popup">
        <img src="" alt="Popup Image" id="popupImg">
    </div>

    <script>
        const container = document.getElementById('giftContainer');
        const popup = document.getElementById('popup');
        const popupImg = document.getElementById('popupImg');

        let baseTopPositions = [];
        let cloneCycle = 1;

        // احفظ الأماكن الأصلية
        document.querySelectorAll('.gift').forEach(gift => {
            baseTopPositions.push(parseFloat(gift.style.top));
        });

        // التعامل مع الضغط
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('gift')) {
                popupImg.src = 'https://i.imgur.com/XM4T2bF.png'; // صورة مؤقتة
                popup.style.display = 'block';
                setTimeout(() => popup.style.display = 'none', 2000);
            }
        });

        // التكرار التلقائي عند الاقتراب من نهاية الصفحة
        window.addEventListener('scroll', () => {
            const scrollBottom = window.scrollY + window.innerHeight;
            if (scrollBottom >= document.body.scrollHeight - 1500) {
                baseTopPositions.forEach((top, i) => {
                    const gift = document.createElement('img');
                    gift.src = "https://i.imgur.com/1XjK6uK.png";
                    gift.className = 'gift';
                    gift.style.top = (top + 2400 * cloneCycle) + 'px';
                    gift.style.left = (50 + 100 * i) + 'px';
                    container.appendChild(gift);
                });
                cloneCycle++;
            }
        });
    </script>

</body>

</html>